<div class="absolute inset-0 min-w-0 overflow-auto print:overflow-visible" cdkScrollable>
    <div class="inline-block p-4 sm:p-8 print:p-0 w-full">
        <div class="bg-card shadow print:bg-transparent print:p-0 print:shadow-none rounded-2xl mx-auto overflow-hidden w-full max-w-5xl">
            <div class="bg-crediblue-50 px-6 py-4 flex items-center justify-between">
                <div>
                    <a mat-button [routerLink]="['/pages/gestion-creditos/credito-consumos']" class="flex items-center">
                        <mat-icon [svgIcon]="'heroicons_outline:arrow-long-left'" class="text-white"></mat-icon>
                    </a>
                </div>
                <h2 class="text-lg sm:text-xl font-bold text-white">Detalle de Crédito</h2>
            </div>

            <div class="p-4 sm:p-6" *ngIf="items">
                <!-- Información del Cliente y Empresa -->
                <div class="mb-4 grid grid-cols-1 md:grid-cols-2 gap-4 justify-items-stretch lg:justify-items-center">
                    <div>
                        <h3 class="text-lg sm:text-xl font-semibold text-gray-800">{{items.trabajador.primerNombre}} {{items.trabajador.segundoNombre}} {{items.trabajador.primerApellido}} {{items.trabajador.segundoApellido}} </h3>
                        <p class="font-medium text-gray-600">Identificación:
                            <span class="text-md text-secondary">{{items.trabajador.numDoc}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Empresa:
                            <span class="text-md text-secondary">{{items.nombreSubEmpresa}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Cargo:
                            <span class="text-md text-secondary">{{items.trabajador.cargo}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Tipo de contrato:
                            <span class="text-md text-secondary">{{items.trabajador.nombreTipoContrato}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Correo:
                            <span class="text-md text-secondary">{{items.trabajador.correo}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Teléfono:
                            <span class="text-md text-secondary">{{items.trabajador.telefono}}</span>
                        </p>
                    </div>

                    <div>
                        <p class="font-medium text-gray-600">Número de crédito:
                            <span class="text-md text-secondary">{{items.numCredito}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Cupo aprobado:
                            <span class="text-md text-secondary">{{aesEncriptService.decrypt(items.cupoAprobado) | currency}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Cupo utilizado:
                            <span class="text-md text-secondary">{{aesEncriptService.decrypt(items.cupoConsumido) | currency}}</span>
                        </p>
                        <p class="font-medium text-gray-600">Saldo disponible:
                            <span class="text-md text-secondary">{{aesEncriptService.decrypt(items.cupoDisponible) | currency}}</span>
                        </p>
                    </div>
                </div>

                    <div class="grid grid-cols-1 gap-2 justify-items-stretch max-w-lg mb-4 md:grid-cols-3 mx-auto place-content-start">
                        <button
                            mat-flat-button
                            class="lg:w-auto w-full mt-4 bg-green-600 transition duration-200 text-white font-semibold rounded-lg md:w-auto"
                            (click)="onConsumo()"
                        >
                            Registrar consumo
                        </button>
                        <button
                            mat-flat-button
                            class="lg:w-auto w-full mt-4 bg-crediblue-50 hover:bg-crediblue-100 transition duration-200 text-white font-semibold rounded-lg md:w-auto"
                        >
                            Registrar abono
                        </button>
                        <button
                            mat-flat-button
                            class="lg:w-auto w-full mt-4 bg-crediorange-100 transition duration-200 text-white font-semibold rounded-lg md:w-auto"
                            (click)="items.estado ? onBloqueo() : onDesbloqueo()"
                        >
                           {{items.estado ? 'Bloquear' : 'Desbloquear'}} crédito
                        </button>
                    </div>

                <!--<div class="mb-4 grid grid-cols-1 md:grid-cols-2 gap-4 justify-items-stretch lg:justify-items-center place-content-start">
                    <button
                        mat-flat-button
                        class="lg:w-auto w-full mt-4 bg-green-600 transition duration-200 text-white font-semibold rounded-lg md:w-auto"

                    >
                        Refinanciar
                    </button>
                </div>-->
                <hr class="my-4">

                <p class="text-lg sm:text-xl font-semibold text-gray-800 text-center mb-6" *ngIf="items.detalleCreditoConsumos">Movimientos</p>
                <div class="mb-4" *ngIf="items.detalleCreditoConsumos">
                    <div class="flex flex-wrap gap-2.5 justify-center">
                        <ng-container *ngFor="let item of items.detalleCreditoConsumos">
                            <fuse-card
                                class="flex flex-col p-4 rounded-2xl shadow-lg w-full md:w-1/2 lg:w-1/3"
                            >
                                <div class="flex justify-between">
                                    <p class="font-medium text-gray-600">{{item.nombreSubEmpresa}}</p>
                                    <p class="font-medium text-gray-600">{{item.fechaCreacion | date: 'dd/MM/yyyy'}}</p>
                                </div>
                                <div class="flex justify-between">
                                    <p class="font-medium text-gray-600">Factura: {{item.numeroFactura}}</p>
                                    <p class="font-medium text-gray-600">Valor: {{aesEncriptService.decrypt(item.montoConsumo) | currency}}</p>
                                </div>
                                <!--<div class="w-full mt-2">
                                    <p class="h-2.5 rounded-full" [ngClass]="{
                                           'bg-green-600':  item.idEstadoCredito == CodigosDetalleConsumo.APROBADA,
                                           'bg-yellow-600': item.idEstadoCredito == CodigosDetalleConsumo.EN_REVISION,
                                           'bg-red-600': item.idEstadoCredito == CodigosDetalleConsumo.RECHAZADA
                                           }">
                                    </p>
                                </div>-->
                                @if (item.idEstadoCredito == CodigosDetalleConsumo.EN_REVISION) {
                                    <button
                                        mat-flat-button
                                        class="lg:w-auto w-full mt-4 bg-crediorange-100 transition duration-200 text-white font-semibold rounded-lg md:w-auto"

                                    >
                                        Eliminar cobro
                                    </button>
                                }
                            </fuse-card>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
